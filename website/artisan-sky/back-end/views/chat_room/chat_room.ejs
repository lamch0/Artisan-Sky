<!-- <!-- <html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
			integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
			crossorigin="anonymous"
		/>
		<link href="/css/style.css" />
		<link href="signin.css" rel="stylesheet">
		<title>Artisan Sky Chatroom</title>
		<style>
			@import url('https://fonts.googleapis.com/css?family=Roboto&display=swap');

:root {
	--dark-color-a: #667aff;
	--dark-color-b: #7386ff;
	--light-color: #e6e9ff;
	--success-color: #5cb85c;
	--error-color: #d9534f;
}

* {
	box-sizing: border-box;
	margin: 0;
	padding: 0;
}

body {
	font-family: 'Roboto', sans-serif;
	font-size: 16px;
	background: var(--light-color);
	margin: 20px;
}

ul {
	list-style: none;
}

a {
	text-decoration: none;
}

.btn {
	cursor: pointer;
	padding: 5px 15px;
	background: var(--light-color);
	color: var(--dark-color-a);
	border: 0;
	font-size: 17px;
}

/* Chat Page */

.chat-container {
	max-width: 1100px;
	background: #fff;
	margin: 30px auto;
	overflow: hidden;
}

.chat-header {
	background: var(--dark-color-a);
	color: #fff;
	border-top-left-radius: 5px;
	border-top-right-radius: 5px;
	padding: 15px;
	display: flex;
	align-items: center;
	justify-content: space-between;
}

.chat-main {
	display: grid;
	grid-template-columns: 1fr 3fr;
}

.chat-sidebar {
	background: var(--dark-color-b);
	color: #fff;
	padding: 20px 20px 60px;
	overflow-y: scroll;
}

.chat-sidebar h2 {
	font-size: 20px;
	background: rgba(0, 0, 0, 0.1);
	padding: 10px;
	margin-bottom: 20px;
}

.chat-sidebar h3 {
	margin-bottom: 15px;
}

.chat-sidebar ul li {
	padding: 10px 0;
}

.chat-messages {
	padding: 30px;
	max-height: 500px;
	overflow-y: scroll;
}

.chat-messages .message {
	padding: 10px;
	margin-bottom: 15px;
	background-color: var(--light-color);
	border-radius: 5px;
	overflow-wrap: break-word;
}

.chat-messages .message .meta {
	font-size: 15px;
	font-weight: bold;
	color: var(--dark-color-b);
	opacity: 0.7;
	margin-bottom: 7px;
}

.chat-messages .message .meta span {
	color: #777;
}

.chat-form-container {
	padding: 20px 30px;
	background-color: var(--dark-color-a);
}

.chat-form-container form {
	display: flex;
}

.chat-form-container input[type='text'] {
	font-size: 16px;
	padding: 5px;
	height: 40px;
	flex: 1;
}

/* Join Page */
.join-container {
	max-width: 500px;
	margin: 80px auto;
	color: #fff;
}

.join-header {
	text-align: center;
	padding: 20px;
	background: var(--dark-color-a);
	border-top-left-radius: 5px;
	border-top-right-radius: 5px;
}

.join-main {
	padding: 30px 40px;
	background: var(--dark-color-b);
}

.join-main p {
	margin-bottom: 20px;
}

.join-main .form-control {
	margin-bottom: 20px;
}

.join-main label {
	display: block;
	margin-bottom: 5px;
}

.join-main input[type='text'] {
	font-size: 16px;
	padding: 5px;
	height: 40px;
	width: 100%;
}

.join-main select {
	font-size: 16px;
	padding: 5px;
	height: 40px;
	width: 100%;
}

.join-main .btn {
	margin-top: 20px;
	width: 100%;
}

@media (max-width: 700px) {
	.chat-main {
		display: block;
	}

	.chat-sidebar {
		display: none;
	}
}

		</style>
	</head>
	<body>
		<div class="join-container">
			<header class="join-header">
				<h1><i class="fas fa-smile"></i>Artisan Sky Chat</h1>
			</header>
			<main class="join-main">
				<form action="/chat">
					<div class="form-control">
						<label for="username">Username</label>
						<input
							type="text"
							name="username"
							id="username"
							placeholder="Enter username..."
							required
						/>
					</div>
					<div class="form-control">
						<label for="room">Room</label>
						<select name="room" id="room">
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
							<option value="6">6</option>
						</select>
					</div>
					<button type="submit" class="btn">Join Chat</button>
				</form>
			</main>
		</div>
	</body>
</html> -->

<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
		integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
	<link href="css/style.css" />

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

	<!-- Bootstrap core CSS -->
	<link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">

	<style>
		@import url('https://fonts.googleapis.com/css?family=Roboto&display=swap');

		:root {
			--dark-color-a: #315582;
			--dark-color-b: #76a0e4;
			--light-color: #e8f2fd;
			--success-color: #b9ffaa;
			--error-color: #e0403b;
		}

		* {
			box-sizing: border-box;
			margin: 0;
			padding: 0;
		}

		body {
			font-family: 'Roboto', sans-serif;
			font-size: 16px;
			background: var(--light-color);
			margin: 20px;
		}

		ul {
			list-style: none;
		}

		a {
			text-decoration: none;
		}

		.btn {
			cursor: pointer;
			padding: 5px 15px;
			background: var(--light-color);
			color: var(--dark-color-a);
			border: 0;
			font-size: 17px;
		}

		/* Chat Page */

		.chat-container {
			max-width: 1100px;
			background: #fff;
			margin: 30px auto;
			overflow: hidden;
		}

		.chat-header {
			background: var(--dark-color-a);
			color: #fff;
			border-top-left-radius: 5px;
			border-top-right-radius: 5px;
			padding: 15px;
			display: flex;
			align-items: center;
			justify-content: space-between;
		}

		.chat-main {
			display: grid;
			grid-template-columns: 1fr 3fr;
		}

		.chat-sidebar {
			background: #ffa958;
			color: #fff;
			padding: 20px 20px 60px;
			overflow-y: scroll;
		}

		.chat-sidebar h2 {
			font-size: 20px;
			background: rgba(0, 0, 0, 0.1);
			padding: 10px;
			margin-bottom: 20px;
		}

		.chat-sidebar h3 {
			margin-bottom: 15px;
		}

		.chat-sidebar ul li {
			padding: 10px 0;
		}

		.chat-messages {
			padding: 30px;
			max-height: 500px;
			overflow-y: scroll;
		}

		.chat-messages .message {
			padding: 10px;
			margin-bottom: 15px;
			background-color: var(--light-color);
			border-radius: 5px;
			overflow-wrap: break-word;
		}

		.chat-messages .message .meta {
			font-size: 15px;
			font-weight: bold;
			color: var(--dark-color-b);
			opacity: 0.7;
			margin-bottom: 7px;
		}

		.chat-messages .message .meta span {
			color: #777;
		}

		.chat-form-container {
			padding: 20px 30px;
			background-color: var(--dark-color-b);
		}

		.chat-form-container form {
			display: flex;
		}

		.chat-form-container input[type='text'] {
			font-size: 16px;
			padding: 5px;
			height: 40px;
			flex: 1;
		}

		@media (max-width: 700px) {
			.chat-main {
				display: block;
			}

			.chat-sidebar {
				display: none;
			}
		}
	</style>
	<title>Artisan Sky Chatroom</title>
</head>

<body>
	<!-- Sidebar-->
	<!-- <div>
       
      <nav class="col-sm-4 d-flex flex-column flex-shrink-0 p-3 text-white bg-dark" style="width: 280px; height: 100vh;">
        <a href="#" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
          <img class="bi me-2" width="50" height="40" src="Artisans_Sky.png" alt="logo">
          <span class="fs-4">Artisan's Sky</span>
        </a>
        <hr>
        <ul class="nav nav-pills flex-column mb-auto">
          <li class="nav-item">
            <a href="#" class="nav-link text-white" aria-current="page">
              <svg class="bi me-2" width="16" height="16">
                <use xlink:href="#home" />
              </svg>
              Home
            </a>
          </li>
          <li>
            <a href="#" class="nav-link text-white">
              <svg class="bi me-2" width="16" height="16"><use xlink:href="#collection"/></svg>
              My Post
            </a>
          </li>
          <li>
            <a href="#" class="nav-link active">
              <svg class="bi me-2" width="16" height="16"><use xlink:href="#people-circle"/></svg>
              Chat
            </a>
          </li>
        </ul>
        <hr>
        <div class="dropdown">
          <a href="#" class="d-flex align-items-center text-white text-decoration-none" id="dropdownUser1"
            data-bs-toggle="dropdown" aria-expanded="false">

            <strong>Login</strong>
          </a>
        </div>
      </nav>
    </div> 


	<div class="chat-container">
		<header class="chat-header">
			<h1><i class="fas fa-smile"></i> Artisan Sky Chat</h1>
			<a id="leave-btn" class="btn">Leave Room</a>
		</header>
		<main class="chat-main">
			<div class="chat-sidebar">
				<h3><i class="fas fa-comments"></i> Room Name:</h3>
				<h2 id="room-name"></h2>
				<h3><i class="fas fa-users"></i> Users</h3>
				<ul id="users"></ul>
			</div>
			<div class="chat-messages"></div>
		</main>
		<div class="chat-form-container">
			<form id="chat-form">
				<input id="msg" type="text" placeholder="Enter Message" required autocomplete="off" />
				<button class="btn btn-lg btn-primary"><i class="fas fa-paper-plane"></i> Send</button>
			</form>
		</div>
	</div>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.9.2/qs.min.js"
		integrity="sha256-TDxXjkAUay70ae/QJBEpGKkpVslXaHHayklIVglFRT4=" crossorigin="anonymous"></script>
	<script src="/socket.io/socket.io.js"></script>

	<script>
		const chatForm = document.getElementById('chat-form');
		const chatMessages = document.querySelector('.chat-messages');
		const roomName = document.getElementById('room-name');
		const userList = document.getElementById('users');

		// Get username and room from URL
		const { username, room } = Qs.parse(location.search, {
			ignoreQueryPrefix: true,
		});

		const socket = io();

		// Join chatroom
		socket.emit('joinRoom', { username, room });

		// Get room and users
		socket.on('roomUsers', ({ room, users }) => {
			outputRoomName(room);
			outputUsers(users);
		});

		// Message from server
		socket.on('message', (message) => {
			console.log(message);
			outputMessage(message);

			// Scroll down
			chatMessages.scrollTop = chatMessages.scrollHeight;
		});

		// Message submit
		chatForm.addEventListener('submit', (e) => {
			e.preventDefault();

			// Get message text
			let msg = e.target.elements.msg.value;

			msg = msg.trim();

			if (!msg) {
				return false;
			}

			// Emit message to server
			socket.emit('chatMessage', msg);

			// Clear input
			e.target.elements.msg.value = '';
			e.target.elements.msg.focus();
		});

		// Output message to DOM
		function outputMessage(message) {
			const div = document.createElement('div');
			div.classList.add('message');
			const p = document.createElement('p');
			p.classList.add('meta');
			p.innerText = message.username;
			p.innerHTML += `<span> ${message.time}</span>`;
			div.appendChild(p);
			const para = document.createElement('p');
			para.classList.add('text');
			para.innerText = message.text;
			div.appendChild(para);
			document.querySelector('.chat-messages').appendChild(div);
		}

		// Add room name to DOM
		function outputRoomName(room) {
			roomName.innerText = room;
		}

		// Add users to DOM
		function outputUsers(users) {
			userList.innerHTML = ''
			users.forEach((user) => {
				const li = document.createElement('li');
				li.innerText = user.username;
				userList.appendChild(li);
			});
		}

		//Prompt the user before leave chat room
		document.getElementById('leave-btn').addEventListener('click', () => {
			const leaveRoom = confirm('Are you sure you want to leave the chatroom?');
			if (leaveRoom) {
				window.location = '/chatroom';
			} else {
			}
		});

	</script>
</body>

</html> -->

<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		
		<!-- Bootstrap CSS -->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
			integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css"
			integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk="
			crossorigin="anonymous"
		/>
		<!-- Bootstrap core CSS -->
		<link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">

		<link rel="stylesheet" href="css/style.css" />

		<style>
			.bd-placeholder-img {
				font-size: 1.125rem;
				text-anchor: middle;
				-webkit-user-select: none;
				-moz-user-select: none;
				user-select: none;
			}
		
			@media (min-width: 768px) {
				.bd-placeholder-img-lg {
					font-size: 3.5rem;
				}
			}
		</style>

		<!-- Custom styles for this template -->
		<link href="signin.css" rel="stylesheet">

		<title>Join Chat/Artisan's Sky</title>
	</head>
	<body>
		<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
			<symbol id="home" viewBox="0 0 16 16">
				<path
					d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z" />
			</symbol>
			<symbol id="collection" viewBox="0 0 16 16">
				<path
					d="M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-11zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-13z" />
			</symbol>
			<symbol id="people-circle" viewBox="0 0 16 16">
				<path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
				<path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
			</symbol>
		</svg>
		
		
		<div class="row" style="width: 100vw; height: 100vh;">
		
			<!-- Sidebar-->
			<nav class="col-sm-4 d-flex flex-column flex-shrink-0 p-3 text-white bg-dark" style="width: 280px; height: 100vh;">
				<a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
					<img class="bi me-2" width="50" height="40" src="Artisans_Sky.png" alt="logo">
					<span class="fs-4">Artisan's Sky</span>
				</a>
				<hr>
				<ul class="nav nav-pills flex-column mb-auto">
					<li class="nav-item">
						<a href="/" class="nav-link text-white" aria-current="page">
							<svg class="bi me-2" width="16" height="16">
								<use xlink:href="#home" />
							</svg>
							Home
						</a>
					</li>
					<li>
						<a href="/my_posts" class="nav-link text-white">
						  <svg class="bi me-2" width="16" height="16"><use xlink:href="#collection"/></svg>
						  My Post
						</a>
					  </li>
					  <li>
						<a href="/chatroom" class="nav-link active">
						  <svg class="bi me-2" width="16" height="16"><use xlink:href="#people-circle"/></svg>
						  Chat
						</a>
					  </li>
				</ul>
				<hr>
				<div class="dropdown">
					<% if(typeof isLogin !== 'undefined' && isLogin) { %>
						<a href="#" class="d-flex align-items-center text-white text-decoration-none dropdown-toggle"
						id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
						<% if (messages.info) { %>
						<img src=<%= messages.info %> alt="" width="32" height="32" class="rounded-circle me-2"/>
						<% } %>
						<strong><%= name %></strong>
						</a>
						<ul class="dropdown-menu dropdown-menu-dark text-small shadow" aria-labelledby="dropdownUser1">
						<li><a class="dropdown-item" href="/new_post">New post</a></li>
						<li><a class="dropdown-item" href="/profile">Profile</a></li>
						<li>
							<hr class="dropdown-divider">
						</li>
						<li><form action="/logout?_method=DELETE" method = "POST">
							<button class="dropdown-item" type="submit">Sign Out</button>
						</form></li>
						</ul>
			
					  <% } else { %>
						
						<a href="/login" class="d-flex align-items-center text-white text-decoration-none" id="dropdownUser1"  aria-expanded="false">
						  <strong>Login</strong>
						</a>
						
					  <% } %>
							</div>
			</nav>
		
			<!-- Content -->
			<div class="col d-flex text-center" style="width: 100vw">
				<main class="form-signin">
					<form action="/chat">
						<img class="mb-4" src="./Artisans_Sky_Bright.png" alt="" width="90" height="72">
						<h1 class="h3 mb-3 fw-normal">SkyChat</h1>
		
						<div class="form-floating">
							<input type="text" class="form-control" name="username" id="username" placeholder="Username" required>
							<label for="floatingInput">Username</label>
						</div>
						
						<select class="form-select form-select" name="room" id="room">
							<option selected>Select room number</option>
							<option value="1">1</option>
							<option value="2">2</option>
							<option value="3">3</option>
							<option value="4">4</option>
							<option value="5">5</option>
							<option value="6">6</option>
						</select>
						<p></p>
						<button class="w-100 btn btn-lg btn-primary" type="submit">點此來進行激情對話</button>
					</form>
				</main>
			</div>
		</div>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
			crossorigin="anonymous"></script>
	</body>
</html>
